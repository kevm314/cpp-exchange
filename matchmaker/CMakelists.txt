cmake_minimum_required(VERSION 3.1...3.25)
option(MATCHMAKER_TEST "enable test build" OFF)

if (MATCHMAKER_TEST)
    enable_testing()
    include(GoogleTest)
    add_executable(matchmaker-test "")
endif()


set(
    TARGET_SOURCES 
    mock.cpp
)

add_library(matchmaker ${TARGET_SOURCES})


if (MATCHMAKER_TEST OR TEST)
    target_sources(
        matchmaker-test
        PUBLIC
        ${TARGET_SOURCES}
    )
endif()
if (MATCHMAKER_TEST)
    gtest_discover_tests(matchmaker-test)
    target_link_libraries(
        matchmaker-test
        gtest
        gtest_main
        pthread
    )
endif()